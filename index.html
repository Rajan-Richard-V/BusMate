
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BusMate ðŸšŒ</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #121212;
      color: white;
      display: flex;
      justify-content: center;
      align-items: center;
      flex-direction: column;
      min-height: 100vh;
      margin: 0;
    }
    .container {
      background: #1e1e1e;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 0 15px rgba(0, 255, 128, 0.2);
      width: 90%;
      max-width: 600px;
    }
    select, button {
      width: 100%;
      padding: 10px;
      margin: 10px 0;
      border-radius: 5px;
      border: none;
    }
    .output {
      margin-top: 20px;
      padding: 10px;
      background: #2c2c2c;
      border-radius: 8px;
    }
    .bus-item {
      margin: 5px 0;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>BusMate ðŸšŒ</h1>
    <button onclick="toggleTheme()">Toggle Theme ðŸŒ“</button>
    <label>Select direction:</label>
    <select id="directionSelect" onchange="refreshLastOption()">
      <option>To Junction</option>
      <option>From Junction</option>
    </select>
    <label>Your location:</label>
    <select id="stopSelect" onchange="refreshLastOption()">
      <option>Perumalpuram (Church Stop)</option>
      <option>New Bus Stand</option>
      <option>Palai Bus Stand</option>
      <option>Vannarpettai</option>
    </select>
    <select onchange="handleBusOption(this.value)">
      <option value="next">Next Bus</option>
      <option value="2hr">Buses in Next 2 Hours</option>
      <option value="all">All Buses Today</option>
    </select>
    <div id="output" class="output">
      Hello, I am BusMate â€” ready to assist you. ðŸš€
    </div>
  </div>

  <script>
    const buses = [
      { name: "Antony", time: "11:40" },
      { name: "Balamithusha", time: "13:00" },
      { name: "Balamithusha", time: "14:55" },
      { name: "Government", time: "15:20" },
      { name: "Government", time: "17:00" },
      { name: "Ananth", time: "17:15" },
      { name: "Balamithusha", time: "17:45" },
      { name: "Ananth", time: "19:05" },
      { name: "Government", time: "20:00" },
      { name: "Ananth", time: "11:20" },
      { name: "Ananth", time: "12:15" },
      { name: "Antony", time: "12:30" },
      { name: "Ananth", time: "13:15" },
      { name: "Antony", time: "15:40" },
      { name: "Ananth", time: "16:10" },
      { name: "Balamithusha", time: "16:50" },
      { name: "VSB", time: "17:00" },
      { name: "Antony", time: "17:15" },
      { name: "Government", time: "17:20" },
      { name: "Ananth", time: "18:20" },
      { name: "Balamithusha", time: "18:50" },
      { name: "VSB", time: "19:45" }
    ];

    let lastMode = "";

    function toggleTheme() {
      document.body.classList.toggle("light");
    }

    function handleBusOption(mode) {
      lastMode = mode;
      const direction = document.getElementById("directionSelect").value;
      const stop = document.getElementById("stopSelect").value;
      const now = new Date();
      const upcoming = [];

      buses.forEach(bus => {
        const [h, m] = bus.time.split(":").map(Number);
        const time = new Date();
        time.setHours(h);
        time.setMinutes(m);
        time.setSeconds(0);

        if (direction === "To Junction") {
          if (stop === "New Bus Stand") time.setMinutes(time.getMinutes() + 5);
          if (stop === "Palai Bus Stand") time.setMinutes(time.getMinutes() + 15);
        } else {
          if (stop === "Palai Bus Stand") time.setMinutes(time.getMinutes() + 10);
          if (stop === "New Bus Stand") time.setMinutes(time.getMinutes() + 20);
        }

        const diff = (time - now) / 60000;
        if (diff >= 0) {
          upcoming.push({ ...bus, adjustedTime: time, diff: Math.floor(diff) });
        }
      });

      let filtered = [];
      if (mode === "next") {
        filtered = upcoming.slice(0, 1);
      } else if (mode === "2hr") {
        filtered = upcoming.filter(b => b.diff <= 120);
      } else {
        filtered = upcoming;
      }

      displayBuses(filtered);
    }

    function displayBuses(busList) {
      const output = document.getElementById("output");
      if (busList.length === 0) {
        output.innerHTML = "ðŸ•“ No buses found for the selected time.";
        return;
      }

      let html = "ðŸ“… <strong>Remaining Buses Today:</strong><br>";
      busList.forEach(bus => {
        const h = bus.adjustedTime.getHours().toString().padStart(2, '0');
        const m = bus.adjustedTime.getMinutes().toString().padStart(2, '0');
        const hr = Math.floor(bus.diff / 60);
        const min = bus.diff % 60;
        const timeStr = hr > 0 ? `${hr} hr ${min} min` : `${min} min`;
        html += `â€¢ ${bus.name} at ${h}:${m} (${timeStr})<br>`;
      });

      output.innerHTML = html;
    }

    function refreshLastOption() {
      if (lastMode) {
        handleBusOption(lastMode);
      }
    }
  </script>
</body>
</html>

</body>
</html>

